<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
  <script src="http://code.jquery.com/jquery-2.0.3.js"></script>
  <title>MMX Signature in HTML</title>
</head>
<body>
  <table style="font-family:Helvetica,Arial,Sans-Serif;">
    <tr>
      <td><label for="name">Name</label></td>
      <td><input id="name" size="21"></input></td>
    </tr>
    <tr>
      <td><label for="position">Position</label></td>
      <td><input id="position" size="21"></input></td>
    </tr>
    <tr>
      <td><label for="field1">Field 1</label></td>
      <td><input id="field1Label" maxlength="1" size="2"></input><input id="field1" size="20"></input></td>
    </tr>
    <tr>
      <td><label for="field2">Field 2</label></td>
      <td><input id="field2Label" maxlength="1"  size="2"></input><input id="field2" size="20"></input></td>
    </tr>
    <tr>
      <td><label for="email">Email</label></td>
      <td><input id="email" size="21"></input>@metamarkets.com</td>
    </tr>
  </table>
  <div id="main"></div>
  <script src="target/logo.js"></script>
  <script src="target/signiture.js"></script>
  <script>

  // Init
  $('#name').val(localStorage['name'] || 'Mike Driscoll');
  $('#position').val(localStorage['position'] || 'CEO');
  $('#field1Label').val(localStorage['field1Label'] || 'm');
  $('#field1').val(localStorage['field1'] || '415.860.4347');
  $('#field2Label').val(localStorage['field2Label'] || 't');
  $('#field2').val(localStorage['field2'] || '@medriscoll');
  $('#email').val(localStorage['email'] || 'mike');

  function formatField(str) {
    if (str[0] === '@') return str;
    str = str.replace(/\D/g, '');
    str += '0000000000';
    str = str.substring(0, 10);
    return str.substring(0, 3) + '.' + str.substring(3, 6) + '.' + str.substring(6, 10);
  }

  function render() {
    var name = $('#name').val().substring(0, 20);
    var position = $('#position').val().substring(0, 20);
    var field1Label = $('#field1Label').val().substring(0, 1).toLowerCase();
    var field1 = formatField($('#field1').val().substring(0, 20));
    var field2Label = $('#field2Label').val().substring(0, 1).toLowerCase();
    var field2 = formatField($('#field2').val().substring(0, 20));
    var email = $('#email').val().substring(0, 20);

    localStorage['name'] = name
    localStorage['position'] = position
    localStorage['field1Label'] = field1Label
    localStorage['field1'] = field1
    localStorage['field2Label'] = field2Label
    localStorage['field2'] = field2
    localStorage['email'] = email

    $('#main').html(signiture({
      name: name,
      position: position,
      field1Label: field1Label,
      field1: field1,
      field2Label: field2Label,
      field2: field2,
      email: email + '@metamarkets.com'
    }));
  }

  $('#name').keyup(render);
  $('#position').keyup(render);
  $('#field1').keyup(render);
  $('#field2').keyup(render);
  $('#email').keyup(render);

  render();
  </script>
</body>
</html>
